# generated by datamodel-codegen:
#   filename:  query-result.schema.json
#   timestamp: 2026-01-05T13:28:53+00:00

from __future__ import annotations

from enum import Enum
from typing import Any, Optional

from pydantic import AwareDatetime, BaseModel, Field


class Status(Enum):
    """
    쿼리 실행 상태
    """

    success = 'success'
    error = 'error'
    partial = 'partial'


class Data(BaseModel):
    """
    쿼리 결과 데이터 (status=success 또는 partial일 때)
    """

    rows: Optional[list[dict[str, Any]]] = None
    """
    조회된 데이터 행 목록
    """
    aggregations: Optional[dict[str, Any]] = None
    """
    집계 결과 (operation=aggregate일 때)
    """


class Metadata(BaseModel):
    """
    쿼리 실행 메타데이터
    """

    execution_time_ms: Optional[int] = Field(None, alias='executionTimeMs')
    """
    쿼리 실행 시간 (밀리초)
    """
    rows_returned: Optional[int] = Field(None, alias='rowsReturned')
    """
    반환된 행 개수
    """
    total_rows: Optional[int] = Field(None, alias='totalRows')
    """
    전체 행 개수 (COUNT 쿼리 실행 시)
    """
    data_source: Optional[str] = Field(
        None, alias='dataSource', examples=['postgresql', 'redis', 'elasticsearch']
    )
    """
    데이터 소스 식별자
    """
    executed_at: Optional[AwareDatetime] = Field(None, alias='executedAt')
    """
    쿼리 실행 시각 (ISO 8601)
    """


class Pagination(BaseModel):
    """
    페이징 정보 (결과가 여러 페이지일 때)
    """

    query_token: Optional[str] = Field(None, alias='queryToken')
    """
    다음 페이지 조회용 토큰
    """
    has_more: Optional[bool] = Field(None, alias='hasMore')
    """
    다음 페이지 존재 여부
    """
    current_page: Optional[int] = Field(None, alias='currentPage')
    """
    현재 페이지 번호 (1부터 시작)
    """


class Error(BaseModel):
    """
    에러 정보 (status=error일 때)
    """

    code: str = Field(
        ...,
        examples=[
            'VALIDATION_ERROR',
            'EXECUTION_ERROR',
            'PERMISSION_DENIED',
            'TIMEOUT',
        ],
    )
    """
    에러 코드
    """
    message: str
    """
    에러 메시지 (사용자 친화적)
    """
    details: Optional[str] = None
    """
    상세 에러 정보 (디버깅용)
    """
    field: Optional[str] = None
    """
    에러 발생 필드 (Validation error일 때)
    """


class Warning(BaseModel):
    code: str = Field(..., examples=['SLOW_QUERY', 'LARGE_RESULT', 'DEPRECATED_FIELD'])
    message: str


class QueryResult(BaseModel):
    """
    Core API가 AI Orchestrator에 반환하는 쿼리 실행 결과
    """

    request_id: str = Field(..., alias='requestId')
    """
    요청 ID (QueryPlan의 requestId와 동일)
    """
    status: Status
    """
    쿼리 실행 상태
    """
    data: Optional[Data] = None
    """
    쿼리 결과 데이터 (status=success 또는 partial일 때)
    """
    metadata: Optional[Metadata] = None
    """
    쿼리 실행 메타데이터
    """
    pagination: Optional[Pagination] = None
    """
    페이징 정보 (결과가 여러 페이지일 때)
    """
    error: Optional[Error] = None
    """
    에러 정보 (status=error일 때)
    """
    warnings: Optional[list[Warning]] = None
    """
    경고 메시지 목록 (쿼리는 성공했지만 주의사항이 있을 때)
    """
